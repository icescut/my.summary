# python运算符
运算符分为一元、二元、三元运算符，根据操作数的数量划分。  
python运算符中没有自增和自减。可以写`++a`，但实际上等价于`+(+a)`。  

大纲：
* 算术运算符
* 比较运算符
	* 序列比较
* 赋值运算符
	* 链式赋值
	* 增量赋值
	* 解压赋值
* 逻辑运算符
* 成员运算符
* 身份运算符
* 位运算符
* 操作符优先级

## 算术运算符
算术运算符都是二元操作符，一般用于数值之间的运算，基本与数学上的运算符一致。  
python算术运算符有如下几种：  
* `+` 加
* `-` 减
* `*` 乘
* `/` 除
* `%` 取模
* `//` 整除
* `**` 幂

### 加法
一般用于计算两个数值之和。  
```python
>>> 1 + 2
3
>>> 1.3 + 2.7
4.0
>>> 4 + 7.1
11.1
```

另外加法可以用于序列(字符串、列表、元组)之间的拼接。
```python
>>> 'hello' + ' world'
'hello world'
>>> [1, 2, 3] + [4, 5, 6]
[1, 2, 3, 4, 5, 6]
>>> (1, 2) + (3, 4)
(1, 2, 3, 4)
```

但不同类型变量、常量之间不能相加。  
```python
>>> 1 + 'hello'
Traceback (most recent call last):
  File "<pyshell#4>", line 1, in <module>
    1 + 'hello'
TypeError: unsupported operand type(s) for +: 'int' and 'str'
```

### 减法
一般用于计算两个数值之差。  
```python
>>> 9 - 2
7
>>> 10.3 - 4.2
6.1000000000000005
>>> 9 - 3.2
5.8
```

另外减法用于集合(set)是求集合的差集。  
```python
>>> a = {'hi', 'hello', 'good morning', 'good night'}
>>> b = {'hello', 'good night'}
>>> a - b
{'good morning', 'hi'}
```

### 乘法
一般用于计算两个数值的乘积。    
```python
>>> 2 * 3
6
>>> 2.4 * 5.2
12.48
>>> 2.2 * 3
6.6000000000000005
```

另外乘法可以用于序列(字符串、列表、元组)的重复，语法为`序列 * 整数`。  
```python
>>> 'hi' * 4
'hihihihi'
>>> [1, 2] * 3
[1, 2, 1, 2, 1, 2]
```

但序列之间不能相乘，这样是语法不允许的且没有意义的。  

### 除法
用于计算两个数值的商。  
python 2中，两个整数的商会截断为整数，但python 3则不会截断，两个整数的商如果实际是浮点数则会返回浮点数。  
```python
>>> 3 / 2
1.5
>>> 3.5 / 4
0.875
```

### 取模
用于返回两个数除法的余数。  
```python
>>> 7 % 2
1
>>> 9.2 % 4
1.1999999999999993
>>> 9.3 % 1.7
0.8000000000000009
```

负数取模(tbc)

### 整除
用于返回两个数除法的商的整数(丢弃小数部分)。  
```python
>>> 7 / 2
3.5
>>> 7 // 2
3
>>> 9.2 / 4
2.3
>>> 9.2 // 4
2.0
>>> 9.3 / 1.7
5.470588235294119
>>> 9.3 // 1.7
5.0
```

### 幂
返回x的y次幂。  
```python
>>> 2 ** 3
8
>>> 2.2 ** 2
4.840000000000001
>>> 2 ** -1
0.5
>>> -2 ** -1
-0.5
```

## 比较运算符
比较运算符都是二元运算符，比较的结果为布尔值(True/False)。  
比较运算符有如下几种：  
* `==` 等于
* `!=` 不等于
* `>` 大于
* `<` 小于
* `>=` 大于等于
* `<=` 小于等于

```python
>>> 2 == 2
True
>>> 2 != 3
True
>>> 2.4 > 2.3
True
>>> 2.2 < 2.1
False
>>> 2.01 >= 2
True
>>> 2.01 <= 2.01
True
```

### 不同类型
不同类型变量、常量之间可以进行等性比较(`==`或`!=`)，但不能进行大小比较，并且它们总是不相等的。  
```python
>>> 2 == '2'
False
>>> 2 == [2]
False
>>> [] == False
False
>>> [] != False
True
```

### 布尔值
有个例外是布尔值可以与数值进行等性和大小比较，这时`True`相当于1，`False`相当于0。  
```python
>>> 1 == True
True
>>> 2 > True
True
>>> 0 != False
False
>>> 3 < False
False
```

### 序列比较
序列比较是从左往右依次比较两个序列中的元素(按前面的规则)。如果a序列有n个元素，b序列有n+m个元素，并且前面n个元素都相等，这时判定b序列更大。  
```python
>>> 'hello' == 'hello'
True
>>> (1, 2, 3) > (1, 2)
True
>>> (1, 2, 3) < (1, 3, 2)
True
```

## 赋值运算符

### 基本赋值
python的变量在赋值前无需定义，直接使用`a = 1`即可。但在使用前必须先赋值。  
一个变量可以赋一种类型的值(比如数值)，接下来可以赋另外一种类型值(比如字符串)给它，这就是所谓动态类型。  
动态类型在开发大型项目时有其缺点：  
* 因为无法预先确定类型，当代码量增加时，开发人员可能会混淆。  
* 无法进行编译时优化。  

```python
>>> a = 1
>>> a
1
>>> a = 'hi'
>>> a
'hi'
```

### 链式赋值
支持链式赋值，比如`a = b = 10`，相当于先执行`b = 10`，再执行`a = b`。  

### 增量赋值
可以与算术运算符组合起来进行增量赋值。  
* `+=` 加法赋值运算符，`c += a`等效于`c = c + a`
* `-=` 减法赋值运算符，`c -= a`等效于`c = c - a`
* `*=` 乘法赋值运算符，`c *= a`等效于`c = c * a`
* `/=` 除法赋值运算符，`c /= a`等效于`c = c / a`
* `%=` 取模赋值运算符，`c %= a`等效于`c = c % a`
* `//=` 整除赋值运算符，`c //= a`等效于`c = c // a`
* `**=` 幂赋值运算符，`c **= a`等效于`c = c ** a`

### 解压赋值
任何的序列（或者是可迭代对象）可以通过一个简单的赋值语句解压并赋值给多个变量。 唯一的前提就是变量的数量必须跟序列元素的数量是一样的。  
```python
>>> a = (1, 2)
>>> x, y = a
>>> x
1
>>> y
2
>>> data = [ 'ACME', 50, 91.1, (2012, 12, 21) ]
>>> name, shares, price, date = data
>>> name
'ACME'
>>> date
(2012, 12, 21)
>>> name, shares, price, (year, mon, day) = data
>>> name
'ACME'
>>> year
2012
>>> mon
12
>>> day
21
>>> s = 'hello'
>>> a, b, c, d, e = s
>>> a
'h'
>>> b
'e'
```

如果变量个数和序列元素的个数不匹配，会产生一个异常。  
```python
>>> a = (1, 2)
>>> x, y ,z = a
Traceback (most recent call last):
  File "<pyshell#182>", line 1, in <module>
    x, y ,z = a
ValueError: not enough values to unpack (expected 3, got 2)
```

**星号表达式**  
如果想匹配一部分序列，可以使用星号表达式。星号表达式专门用于数量不确定的情况。  
```python
>>> record = ('Dave', 'dave@example.com', '773-555-1212', '847-555-1212')
>>> name, email, *phone_numbers = record
>>> name
'Dave'
>>> email
'dave@example.com'
>>> phone_numbers
['773-555-1212', '847-555-1212']
>>> *prefixs, current = [1, 2, 3, 4, 5]
>>> prefixs
[1, 2, 3, 4]
```

**丢弃**  
有时候，你想解压一些元素后丢弃它们，可以使用一个普通的废弃名称，比如`_` 或者`ign`（ignore）
```python
>>> x, _, y = (1, 0, 2)
>>> x
1
>>> y
2
>>> x, *_, y = (1, 'x', 'y', 'y', 2)
>>> x
1
>>> y
2
```

## 逻辑运算符
逻辑运算符用于对布尔值进行运算。  
* `and` 与运算
* `or` 或运算
* `not` 非运算

```python
>>> True and True
True
>>> True and False
False
>>> True or False
True
>>> False or False
False
>>> not True
False
```

### 布尔值转换
如果操作数不是布尔值，会自动转换为布尔值再进行运算。如下值会自动转换为`False`，其余值转换为`True`:  
* `None`
* `0`
* `""`
* `[]`

```python
>>> not []
True
>>> not [1]
False
>>> not None
True
>>> not 0
True
>>> not ''
True
>>> not "0"
False
```

## 成员运算符
成员运算符用于测试序列、集合中是否包含某成员。  
* `in`
* `not in`

```python
>>> a = [1, 2, 3, 'hi', 'hello']
>>> 'hi' in a
True
>>> 'hello' not in a
False
>>> b = {"a", "b", "c"}
>>> "d" in b
False
```

### 字典
对于字典则是测试字典中是否包含某key值。  
```python
>>> a = {"x": 1, "y": 2}
>>> "x" in a
True
>>> 1 in a
False
```

## 身份运算符
身份运算符用于测试两个标识符是否引用同一个对象。  
* `is`
* `is not`

```python
>>> a = 1
>>> b = 1
>>> a is b
True
>>> b = 2
>>> a is b
False
>>> a = [1, 2, 3]
>>> b = a
>>> a is b
True
>>> import copy
>>> b = copy.deepcopy(a)
>>> a is b
False
```

## 位运算符
位运算是把数值转换为二进制来进行计算的，只能用于整数计算，不能用于浮点数，因为用于浮点数没有意义。  
```python
>>> 2 & 3
2
>>> 2 | 3
3
>>> 2.5 | 3.4
Traceback (most recent call last):
  File "<pyshell#129>", line 1, in <module>
    2.5 | 3.4
TypeError: unsupported operand type(s) for |: 'float' and 'float'
```

位运算符的如下几种：  
* `&` 按位与运算
* `|` 按位或运算
* `^` 按位异或运算
* `~` 按位取反运算
* `<<` 左移运算，高位丢弃，低位补0。
* `>>` 右移运算，低位丢弃，高位补0/1(看是正数为是负数)。

```python
>>> a = 60            # 60 = 0000 0011 1100
>>> b = 13            # 13 = 0000 0000 1101
>>> c = a & b
>>> c                 # 12 = 0000 0000 1100
12
>>> c = a | b
>>> c                 # 61 = 0000 0011 1101
61
>>> c = a ^ b
>>> c                 # 49 = 0000 00110001
49
>>> c = ~a
>>> c                 #-61 = 1111 11000011
-61
>>> c = a << 2
>>> c                 #240 = 0000 11110000
240
>>> c = a >> 2
>>> c                 # 15 = 0000 0000 1111
15
>>> -20 >> 2
-5
>>> -20 << 2
-80
```

## 操作符优先级
一般而言最好是使用`()`来对操作顺序进行限制，但别人不一定会写上括号，这样了解操作符优先级对于阅读别人代码是有帮助的。  
以下列出了从最高到最低优先级的所有运算符：  

| 运算符        | 描述                         |
|--------------|------------------------------|
| `**`         | 幂                           |
| `~+-`        | 按位取反、一元加号、一元减号    |
| `*/%//`      | 乘、除、取模、整除             |
| `>><<`       | 左移、右移                    |
| `&`          | 按位与                       |
| `^竖线`      | 按位异或、按位或              |
| `<=<>>=`     | 小于等于、小于、大于等于、大于 |
| `==!=`       | 等于、不等于                 |
| `=`          | 赋值(包含所有增量赋值)        |
| `is is not`  | 身份运算                     |
| `in not in`  | 成员运算                     |
| `and or not` | 逻辑运算                     |
